/**
* jquery.cashFormat.js
* @author: Egor Skorobogato
* 
* @version: 1.0.0 - 2013-10-08
* 
* Created by Egor Skorobogatov on 2013-10-08. Please report any bugs to https://github.com/git-decadent/cashFormat.js.git
*
* The MIT License (http://www.opensource.org/licenses/mit-license.php)
*
*/
(function(e){var d={},c={8:true,48:true,49:true,50:true,51:true,52:true,53:true,54:true,55:true,56:true,57:true,58:true},h=function h(j){if(j===""){return j}var i="",k=function(n){var m=n.length-1,o=n.split("").reverse(),l="";do{l+=o[m];if(m%3===0&&m!==0){l+=" "}m-=1}while(m>=0);return l.trim()};i+=k(j);return i},g=function(j){var k=0;if(document.selection){j.focus();var i=document.selection.createRange();i.moveStart("character",-j.value.length);k=i.text.length}else{if(j.selectionStart||j.selectionStart=="0"){k=j.selectionStart}}return(k)},a=function(i){return i.replace(/\s/gi,"")},b={separator:"."};var f=function(i,j){this.$el=e(i);this.options=e.extend(b,j);this.$el.addClass("cash-input");this.init()};f.prototype.init=function(){var i=this,j=this.$el.val();if(j===""||j===null||j===undefined){j="0"+this.options.separator+"00"}else{j=j.replace(".",this.options.separator);if(j.search(this.options.separator)<0){j+=this.options.separator+"00"}}this.$el.val(j);this.cacheVal=j;this.$el.on({keyup:function(k){i.handleKeyUp.call(i,k)},keydown:function(k){i.handleKeyDown.call(i,k)},blur:function(){i.handleChange.call(i)}})};f.prototype.handleChange=function(){var i,j;if(this.cacheVal!==null){j=this.cacheVal}else{j=this.$el.val()}i=j.split(this.options.separator);if(i.length===1){j+=this.options.separator+"00"}else{if(i[1].length<=1){j+=i[1].length===0?"00":"0"}}if(i[0]===""){j="0"+j}this.$el.val(j)};f.prototype.handleKeyDown=function(i){if(!c[i.keyCode]){return}this.cacheVal=this.cacheVal===null?this.$el.val():this.cacheVal};f.prototype.handleKeyUp=function(j){if(!c[j.keyCode]){return}var l=a(this.$el.val()),i=/((^0(?=,|\.)|^[123456789]){0,1}[\d]*)[,\.]{1}([\d]{0,2})$/gi.exec(l),k=g(this.$el[0]);if(i===null&&l.split(this.options.separator)[0]!==""){this.$el.val(this.cacheVal)}else{if(i!==null){this.$el.val(h(i[1])+this.options.separator+i[3])}this.cacheVal=null;this.$el[0].setSelectionRange(k,k)}};f.prototype.getValue=function(){return parseFloat(a(this.$el.val().replace(this.options.separator,".")),10)};e.fn.cashFormat=function(){var i=this,j=arguments;if(arguments.length===0||typeof arguments[0]!=="string"){e.each(this,function(k){d["cache_"+k]=new f(i[k],j.length===0?{}:j[0]);i[k].cid="cache_"+k})}else{if(typeof arguments[0]==="string"){e.each(this,function(k){d[i[k].cid][j[0]]()})}}return this}})(jQuery);